# AGENTS.md

本文件定义 Codex/AI 在本仓库中的【工作边界、职责划分、不可违背的规则】。
无论任务大小，均必须遵守本文件。

---

## 一、仓库结构与职责边界（强制）

- frontend/
  - Vue 3 + TypeScript + Vite
  - 仅负责 UI、路由、状态管理、交互
- backend/
  - Bun + Elysia.js + TypeScript
  - 仅负责 API、业务逻辑、鉴权、数据访问、缓存
- 数据库：MySQL 8.0
- 缓存：Redis

### 🚫 严禁行为

- 不跨目录修改无关代码
- 不因“方便”在前端实现后端业务逻辑
- 不在后端写 UI / 页面
- 不在代码中硬编码环境参数（端口、密钥、缓存前缀、连接串等）

---

## 二、通用工作原则（强制）

1) 最小改动原则
- 只修改与当前任务直接相关的文件
- 禁止“顺手重构”“顺手升级依赖”

2) 可运行优先
- 产出必须可运行、可验证
- 给出明确的本地验证命令

3) 不猜测、不假设
- 不假设已有字段、接口、配置
- 需求/字段不明确 → 必须先提问

4) 禁止秘密提交
- 不得写入真实 token / 密钥
- 新增环境变量必须同步 `.env.example`

---

## 三、修改前后的强制说明

### 修改前（必须）

- 用 3～6 条要点说明你理解的需求
- 标明影响范围：frontend / backend / both

### 修改后（必须）

- 明确说明：
  - 改了哪些文件
  - 为什么要改
  - 如何验证成功（命令 + 预期）

---

## 四、代码质量与风格（强制）

- TypeScript 类型安全优先，避免 any
- 关键业务逻辑必须写中文注释
- ESLint / 格式化（如项目配置）必须通过
- 禁止提交未使用代码和大面积无关格式改动

### 编码与字符集约定（强制）

- **凡是编辑、创建、修改包含中文内容的文件，必须使用 UTF-8（无 BOM）编码写入**
- 避免使用可能改变文件编码的工具或自动转换流程（如不受控的格式化、复制粘贴、编码转换工具）
- 提交前若涉及中文内容变更，应确认文件编码未被改变

---

## 五、数据库与命名（强制）

- 数据库表名、字段名：snake_case
- 代码层：camelCase / PascalCase
- 只要涉及数据库命名，前后端必须与表名一致：
  - DB snake_case
  - 前端路由/菜单/权限用 kebab-case（将 `_` 转 `-`）
- 账号/用户名等需要严格区分大小写的字段：使用区分大小写的排序规则（如 *_bin）

---

## 六、配置与环境变量（强制从 env 获取）

- 禁止硬编码：PORT、NODE_ENV、DATABASE_URL、REDIS_URL、CACHE_TTL_SECONDS、CACHE_KEY_PREFIX、JWT_SECRET 等
- 仅使用 `.env` 本地文件；提交只提交 `.env.example`

---

## 七、提交与协作规则

- Git 提交信息使用中文
- 不修改无关文件
- 需求不清晰 → 先提问，禁止自作主张

## 八、默认命令（约定）

前端（进入 frontend/）：
- bun install（或 npm/pnpm，按项目实际为准）
- bun run dev
- bun run build

后端（进入 backend/）：
- bun install
- bun run dev
- bun run test（如项目有）

> 若项目脚本不同，请以各自 package.json scripts 为准，并在对应 README/文档补充。

---

## 九、优先级声明

若本文件与其他文档冲突：
AGENTS.md 优先级最高
